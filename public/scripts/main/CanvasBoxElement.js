
var CanvasBoxElement;CanvasBoxElement=function(){CanvasBoxElement.prototype.objBox=null;CanvasBoxElement.prototype.x=0;CanvasBoxElement.prototype.relativeMousex=0;CanvasBoxElement.prototype.y=0;CanvasBoxElement.prototype.relativeMousey=0;CanvasBoxElement.prototype.z=1;CanvasBoxElement.prototype.dx=0;CanvasBoxElement.prototype.dy=0;CanvasBoxElement.prototype.objBehavior=null;CanvasBoxElement.prototype.objContext=null;CanvasBoxElement.prototype.strClassName='CanvasBoxElement';CanvasBoxElement.prototype.isConnector=false;CanvasBoxElement.prototype.booShowMenu=false;CanvasBoxElement.prototype.objMenu=null;CanvasBoxElement.prototype.fixed=false;CanvasBoxElement.prototype.booDrag=false;CanvasBoxElement.prototype.objMenu=null;CanvasBoxElement.prototype.booMouseOver=false;CanvasBoxElement.prototype.arrButtons=Array();CanvasBoxElement.prototype.intMass=1;CanvasBoxElement.prototype.dblRotate=0;CanvasBoxElement.prototype.toSerialize=function(){objResult({x:this.x,y:this.y,mass:this.intMass,strClassName:strClassName});return objResult;};CanvasBoxElement.prototype.init=function(){return this.objBehavior=New.CanvasBoxBehavior(this);};function CanvasBoxElement(){this.init();}
CanvasBoxElement.prototype.refresh=function(){this.objBox.change();return this;};CanvasBoxElement.prototype.onDraw=function(){this.draw();return this;};CanvasBoxElement.prototype.changeContext=function(){this.objBox.moveTo(this.x,this.y);this.objBox.saveContext();this.objBox.translate(this.x,this.y);if(this.dblRotate%(2*Math.PI)!==0){this.objBox.rotate(this.dblRotate);}
return this;};CanvasBoxElement.prototype.restoreContext=function(){this.objBox.restoreContext();this.objBox.translate(0,0);return this;};CanvasBoxElement.prototype.draw=function(){throw New.CanvasBoxException('Draw Method was not properly defined in the '+strClassName);return this;};CanvasBoxElement.prototype.onMouseOver=function(event){this.booMouseOver=true;return this.objBehavior.onMouseOver(event);};CanvasBoxElement.prototype.onMouseOut=function(event){this.booMouseOver=false;return this.objBehavior.onMouseOut(event);};CanvasBoxElement.prototype.onMouseDown=function(event){return this.objBehavior.onMouseDown(event);};CanvasBoxElement.prototype.onMouseOver=function(event){return this.objBehavior.onMouseOver(event);};CanvasBoxElement.prototype.isActive=function(){return this.intMass!==0&&(this.objBox.objElementSelected===null||this.objBox.objElementSelected===this);};CanvasBoxElement.prototype.onClick=function(event){var objButton,_i,_len,_ref;if(!this.booDrag&&this.isActive()){_ref=this.arrButtons;for(_i=0,_len=_ref.length;_i<_len;_i++){objButton=_ref[_i];if(objButton.booMouseOver){return objButton.onClick(event);}}}
return this.objBehavior.onClick(event);};CanvasBoxElement.prototype.onDblClick=function(event){return this.objBehavior.onDblClick(event);};CanvasBoxElement.prototype.onDrag=function(event){var objButton,_i,_len,_ref;this.booDrag=true;if(this.isActive){_ref=this.arrButtons;for(_i=0,_len=_ref.length;_i<_len;_i++){objButton=_ref[_i];if(objButton.booMouseOver){return objButton.onDrag(event);}}}
return this.objBehavior.onDrag(event);};CanvasBoxElement.prototype.onDrop=function(event){this.booDrag=false;return this.objBehavior.onDrop(event);};CanvasBoxElement.prototype.onTimer=function(event){return this.objBehavior.onTimer(event);};CanvasBoxElement.prototype.onContextMenu=function(event){this.objBox.booShowMenu=!this.objBox.booShowMenu;if(this.objBox.booShowMenu){this.objMenu.intMenuX=this.objBox.mouseX;this.objMenu.intMenuY=this.objBox.mouseY;this.objMenu.objBox=this.objBox;this.objMenu.strActualMenuItem=null;this.objBox.objMenuSelected=this.objMenu;}
return false;};CanvasBoxElement.prototype.getForce=function(objBoxElement){return this.objBehavior.getForce(objBoxElement);};CanvasBoxElement.prototype.getConnectors=function(){var arrConnection,objElement,_i,_len,_ref;arrConnection=[];_ref=this.objBox.arrElements;for(_i=0,_len=_ref.length;_i<_len;_i++){objElement=_ref[_i];if(php.is_object(objElement)&&(objElement.objElementFrom===this||objElement.objElementTo===this)&&objElement!==this){arrConnection.push(objElement);}}
return arrConnection;};CanvasBoxElement.prototype.onDelete=function(event){var objElement,_i,_len,_ref;_ref=this.getConnectors();for(_i=0,_len=_ref.length;_i<_len;_i++){objElement=_ref[_i];objElement.deleteCascade();}
return this;};CanvasBoxElement.prototype.getId=function(){return this.objBox.arrElements.indexOf(this);};CanvasBoxElement.prototype.copy=function(){var objElement;objElement=New[this.strClassName]();objElement.objBehavior=New[this.objBehavior.strClassName](objElement);objElement.x=Math.random()*this.objBox.width;objElement.y=Math.random()*this.objBox.height;this.objBox.addElement(objElement);return objElement;};CanvasBoxElement.prototype.select=function(){this.objBox.objElementSelected=this;this.mass=0;return this;};CanvasBoxElement.prototype.load=function(){if(this.objMenu!==null){this.objMenu.objBox=this.objBox;}
if(this.objBehavior!==null){this.objBehavior.objBox=this.objBox;}
return this;};CanvasBoxElement.prototype.setFixed=function(fixed){this.fixed=fixed;this.draw();return this;};CanvasBoxElement.prototype.goUp=function(){this.setFixed(true);this.y-=10;return this;};CanvasBoxElement.prototype.goDown=function(){this.setFixed(true);this.y+=10;return this;};CanvasBoxElement.prototype.goLeft=function(){this.setFixed(true);this.x-=10;return this;};CanvasBoxElement.prototype.goRight=function(){this.setFixed(true);this.x+=10;return this;};CanvasBoxElement.prototype.isInsideElement=function(mouseX,mouseY){throw new CanvasBoxException('isInsideElement was not properly defined in the '+strClassName);};CanvasBoxElement.prototype.isInside=function(mouseX,mouseY){var booResult,objButton,_i,_len,_ref;booResult=false;this.refresh();if(this.isInsideElement(mouseX,mouseY)){booResult=true;}
if(this.isActive()){_ref=this.arrButtons;for(_i=0,_len=_ref.length;_i<_len;_i++){objButton=_ref[_i];if(objButton.isInside(mouseX,mouseY)){booResult=true;}}}
return booResult;};CanvasBoxElement.prototype.addButton=function(objButton){var objLast;if(this.arrButtons.length>0){objLast=this.arrButtons[this.arrButtons.length-1];objButton.objPreviousButton=objLast;}
this.arrButtons.push(objButton);return this;};CanvasBoxElement.prototype.killMe=function(){return this.objBox.deleteElement(this);};return CanvasBoxElement;}();