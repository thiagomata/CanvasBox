{"version":3,"sources":["CanvasBox.coffee"],"names":[],"mappings":"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","file":"CanvasBox.js","sourceRoot":"/source/","sourcesContent":["###\n# Controls the events into the canvas object emulating some \n# event-based interactions with the virtual canvas box elements\n#\n# @author Thiago Henrique Ramos da Mata <thiago.henrique.mata@gmail.com>\n# @see CanvasBoxElement\n# @see CanvasBoxButton\n###\nLoad.CanvasBoxException();\nclass CanvasBox\n\n    ###\n    # Zoom Distance\n    ###\n    dblZoom: 1\n\n    ###\n    # Counter of Stand By Frames\n    ###\n    intCounterStandyBy: 0\n\n    ###\n    # Position x of the Canvas Box Element relative to the page\n    # @type integer\n    ###\n    x: 0\n    \n    ###\n    # Position y of the Canvas Box Element relative to the page\n    # @type integer\n    ###\n    y: 0\n\n    ###\n    # Id of the Box, to deal with many canvas box into the same page\n    # @type integer\n    ###\n    id: null\n\n    ###\n    # width of the Sand Box\n    # @type integer\n    ###\n    width: 400\n\n    ###\n    # Height of the Sand Box\n    # @type integer\n    ###\n    height: 400\n\n    ###\n    # Width of the Sand Box\n    # @type integer\n    ###\n    defaultWidth: 400\n\n    ###\n    # Height of the Sand Box\n    # @type integer\n    ###\n    defaultHeight: 400\n\n    ###\n    # Html Canvas Box Element\n    # @type Canvas\n    ###\n    objCanvasHtml: null\n\n    ###\n    # Collection of Elements inside the Box\n    # @type CanvasBoxElement[]\n    ###\n    arrElements: Array()\n\n    ###\n    # Collection of CanvasButtons of the Box\n    # \n    # @type CanvasBoxButton[]\n    ###\n    arrButtons: Array()\n    \n    ###\n    # CanvasBoxElement Over\n    # @type CanvasBoxElement\n    ###\n    objElementOver: null,\n\n    ###\n    # CanvasBoxElement Clicked\n    # @type CanvasBoxElement\n    ###\n    objElementClicked: null\n\n    ###\n    # Interval of Image Refreshing\n    # @type integer\n    ###\n    intIntervalDraw: 0\n\n    ###\n    # Interval of Objects Timers\n    # @type integer\n    ###\n    intIntervalTimer: 1\n\n    ###\n    # Control if the refreshing is active or not\n    # @type boolean\n    ###\n    booActive: false\n    \n    ###\n    # Mouse X position relative to canvas box\n    # @integer\n    ###\n    mouseX: 0\n    \n    ###\n    # Mouse Y position relative to canvas box\n    # @integer\n    ###\n    mouseY: 0\n    \n    ###\n    # Flag of control if the canvas box is drawing right now\n    # @type boolean\n    ###\n    booOnDraw: false\n\n    ###\n    # Flag of control if the canvas box is moving right now\n    ###\n    booOnTimer: false\n\n    ###\n    # Flag of the on change event\n    ###\n    booChanged: true\n    \n    ###\n    # Flag of the mouse over event\n    ###\n    booMouseOver: true\n\n    ###\n    # Flag of Draw event \n    ###\n    booDrawBoxMenu: true\n    \n    ###\n    # Javascript constant of right button click\n    ###\n    intRightButtonClick: 2\n\n    ###\n    # Class Name of the Canvas Box\n    # @type string\n    ###\n    strClassName: \"CanvasBox\"\n\n    ###\n    # Frames per Second Counter\n    # @type integer\n    ###\n    intFps: 0\n\n    ###\n    # Frames per Second Last Result\n    # @type integer\n    ###\n    intLastFps: 0\n\n    ###\n    # Flag that controls if the FPS counter is active\n    ###\n    booCountFps: false\n    \n    ###\n    # Background Color of the Canvas Box\n    ###\n    backgroundColor: \"white\"\n\n    ###\n    # Flag that controls if the menu is showing\n    ###\n    booShowMenu: false\n\n    ###\n    # Native Menu element of the Canvas Box\n    ###\n    objMenu: null\n\n    ###\n    # Actual Menu Element of the Canvas\n    ###\n    objMenuSelected: null\n\n    intTimeoutTimer: null\n\n    intTimeoutDraw: null\n\n    intTimeoutFPS: null\n\n    ###\n    # Get the client width fixing browsers missing standarts\n    # @link http:#www.softcomplex.com/docs/get_window_size_and_scrollbar_position.html\n    ###\n    clientWidth: ->\n        return CanvasBox::filterResults(\n            window.innerWidth ?= 0,\n            document.documentElement ?= 0,\n            document.body ?= 0\n        );\n\n    toSerialize: ->\n        objResult = new Object();\n        objResult.x = @x;\n        objResult.y = @y;\n        objResult.width = @width;\n        objResult.height = @height;\n        objResult.objCanvasHtml = @objCanvasHtml;\n        objResult.intIntervalDraw = @intIntervalDraw;\n        objResult.booActive = @booActive;\n        objResult.booOnDraw = @booOnDraw;\n        objResult.arrElements = @arrElements;\n        return objResult;\n\n    ###\n    # Method that defined the Native Menu of the Canvas Box.\n    # \n    # This menu will be see when the user right click into some\n    # empty area of the canvas box \n    # \n    # @return CanvasBox\n    ###\n    defineMenu: ->\n        @objMenu = New.CanvasBoxMenu();\n        @objMenu.objParent = this;\n        @objMenu.objBox = this;\n        @objMenu.arrMenuItens =\n            0:\n                name: \"create class\",\n                event: ( objParent )->\n                    objClass = New.CanvasBoxClass();\n                    objClass.objBehavior = New.CanvasBoxMagneticBehavior( objClass );\n                    objClass.x = objParent.mouseX;\n                    objClass.y = objParent.mouseY;\n                    objParent.addElement( objClass );\n            1:\n                name: \"create square\",\n                event:( objParent )->\n                    objSquare = New.CanvasBoxSquare();\n                    objSquare.objBehavior = New.CanvasBoxMagneticBehavior( objSquare );\n                    objSquare.x = objParent.mouseX;\n                    objSquare.y = objParent.mouseY;\n                    objParent.addElement( objSquare );\n                    \n        @objMenuSelected = null;\n        return this;\n\n    ###\n    # Calculates the absolute position of the canvas box object based\n    # on the position of the parents objects\n    # \n    # @return CanvasBox\n    ###\n    getPosition: ->\n        x = @objCanvasHtml.offsetLeft;\n        y = @objCanvasHtml.offsetTop;\n        objElement = @objCanvasHtml;\n\n        while( objElement.offsetParent )\n            if( objElement == document.getElementsByTagName( 'body' )[0] )\n                break;\n            else\n                x =  x + objElement.offsetParent.offsetLeft;\n                y =  y + objElement.offsetParent.offsetTop;\n                objElement = objElement.offsetParent;\n        @x = x;\n        @y = y;\n        return this;\n\n    ###\n    # Change the background color\n    #\n    # @param strNewBackgroundColor string \n    # @return CanvasBox\n    ###\n    setBackgroundColor:(strNewBackgroundColor)->\n        @backgroundColor = strNewBackgroundColor;\n        @objCanvasHtml.style.backgroundColor = @backgroundColor;\n        return this\n\n    ###\n    # Initialize the Canvas Box\n    #\n    # - Validate the canvas html element\n    # - set the width and the height into the canvas html element\n    #\n    # @param idCanvasHtmlElement string\n    # @throws CanvasBoxException\n    # \n    # @return CanvasBox\n    ###\n    constructor: ( idCanvasHtmlElement , intWidth = 400 , intHeight = 400)->\n        console.log( \"canvasbox constructor #{idCanvasHtmlElement}\" )\n        \n        @defaultWidth = intWidth;\n        @defaultHeight = intHeight;\n        @width = @defaultWidth / @dblZoom;\n        @height = @defaultHeight / @dblZoom;\n        @id = CanvasBox::arrInstances.length;\n        CanvasBox::arrInstances[ @id ] = this;\n\n        @objCanvasHtml = document.getElementById( idCanvasHtmlElement );\n        if( @objCanvasHtml == null )\n            throw New.CanvasBoxException( \"Invalid canvas html element id [\" + idCanvasHtmlElement + \"]\" );\n        @getPosition();\n\n        strWidth = \"#{@defaultWidth}px\";\n        @objCanvasHtml.setAttribute( \"width\" ,  strWidth );\n        #@objCanvasHtml.style.width = strWidth;\n        #@objCanvasHtml.width = strWidth;\n\n        strHeight = \"#{@defaultHeight}px\";\n        @objCanvasHtml.setAttribute( \"height\" , strHeight );\n        #@objCanvasHtml.style.height = strHeight;\n        #@objCanvasHtml.height = strHeight;\n\n        @objCanvasHtml.setAttribute( \"contentEditable\" , \"true\");\n        @objCanvasHtml.contentEditable = true;\n\n        @objCanvasHtml.addEventListener(\n            'mousemove', \n            (event) =>\n                @onMouseMove( event );\n        )\n        \n        @objCanvasHtml.addEventListener(\n            'click' , \n            (event) =>\n                @onClick( event );\n        )\n\n        @objCanvasHtml.addEventListener( \n            'dblclick' , \n            (event) =>\n                @onDblClick( event );\n        )\n\n        @objCanvasHtml.addEventListener( \n            'mouseup' , \n            (event) =>\n                @onMouseUp( event );\n        )\n\n        @objCanvasHtml.addEventListener(\n            'mousedown',\n            (event) =>\n                @onMouseDown( event );\n        )\n\n        @objCanvasHtml.addEventListener(\n            'contextmenu',\n            (event) =>\n                @onContextMenu( event );\n        )\n\n        @objCanvasHtml.addEventListener( \n            'keyup',\n            (event) =>\n                @onKeyUp( event );\n        )\n\n        @objCanvasHtml.addEventListener(\n            'mouseout',\n            (event) =>\n                @onMouseOut( event );\n        )\n\n        @objCanvasHtml.addEventListener(\n            'mouseover',\n            (event) =>\n                @onMouseOver( event );\n        )\n\n        @defineMenu();\n        @play();\n\n        ###\n        @objBox = this;\n        objButton = New.CanvasBoxZoomInButton( this );\n        @addButton( objButton );\n        objButton = New.CanvasBoxZoomOutButton( this );\n        @addButton( objButton );\n        objButton = New.CanvasBoxExportButton( this );\n        @addButton( objButton );\n        objButton = New.CanvasBoxSaveButton( this );\n        @addButton( objButton );        \n        ###\n        @init();\n\n        return this;\n\n    ###\n    # The extended version of the constructor without the need of parent method call.\n    #\n    # in the parent, do nothing\n    ###\n    init:()->\n        # do nothing\n\n    ###\n    # Add a CanvasBoxElement intot he CanvasBox\n    #\n    # @param objElement CanvasBoxElement\n    ###\n    addElement: ( objElement )->\n        @arrElements.push( objElement );\n        objElement.objBox = this;\n        objElement.objContext = @getContext();\n        objElement.load();\n        \n    ###\n    # Get the Context of the Canvas Html Element\n    # @return CanvasRenderingContext2D\n    ###\n    getContext: ->\n        objContext = @objCanvasHtml.getContext( '2d' );\n        return objContext;\n        \n    ###\n    # Clear the image into the Canvas Html Element Context\n    ###\n    clear: ->\n        objContext = @getContext();\n        objContext.clearRect( \n            0,\n            0,\n            Math.max( @width , @defaultWidth ),\n            Math.max( @height , @defaultHeight )\n        );\n        @defaultStyle();\n        \n\n    ###\n    # Draw all the elements into the CanvasBox\n    ###\n    draw: ->\n        if( not @booChanged )\n            @intCounterStandyBy++;\n            return;\n        @intCounterStandyBy = 0;\n\n        @booOnDraw = true;\n\n        @clear();\n\n        arrLayers = Array();\n\n        ###\n        # Create one array to each layer into the z dimension\n        ###\n        for objElement in @arrElements\n            if( not arrLayers[ objElement.z ]? )\n                arrLayers[ objElement.z ] = Array();\n            arrLayers[ objElement.z ].push( objElement );\n\n        ###\n        # Order layers by the z dimension\n        ###\n        arrLayers = php.sort( arrLayers );\n\n        ###\n        # Draw Elements each z dimension layer of time\n        ###\n        for arrLayerElements in arrLayers\n            for objElement in arrLayerElements\n                if( objElement? )\n                    objElement.onDraw();\n\n        objElement = null;\n\n        if( @booShowMenu )\n            @objMenuSelected.mouseX = @mouseX;\n            @objMenuSelected.mouseY = @mouseY;\n            @objMenuSelected.onDraw();\n\n        if( @booDrawBoxMenu )\n            for objButton in @arrButtons\n                objButton.refresh();\n                objButton.onDraw();\n        \n        @booOnDraw = false;\n        @booChanged = false;\n\n    ###\n    # Draw all the elements into the CanvasBox\n    ###\n    onTimerElements: ->\n        @booOnTimer = true;\n\n        for objElement in @arrElements\n            if( php.is_object( objElement ) )\n                objElement.onTimer();\n        @booOnTimer = false;\n\n    ###\n    # Active the auto refresh timer\n    ###\n    play: ->\n        @intCounterStandyBy = 0;\n        if( @booActive )\n            return;\n        @booActive = true;\n        @intTimeoutTimer = setTimeout( this.onTimer.bind( this ) , @intIntervalTimer );\n        @intTimeoutDraw = setTimeout( this.onDraw.bind( this ) , @intIntervalDraw );\n        @intTimeoutFPS = setTimeout( this.onCountFps.bind( this ) , 1000 );\n\n    ###\n    # Stop the auto refresh timer\n    ###\n    stop:->\n        @booActive = false;\n        window.clearTimeout( @intTimeoutTimer );\n        window.clearTimeout( @intTimeoutDraw );\n        window.clearTimeout( @intTimeoutFPS );\n\n    ###\n    # Refresh the Canvas Box\n    #\n    # - Draw the elements\n    # - Call the next timer if should\n    # @return boolean\n    ###\n    onTimer:->\n        if( @booActive == false )\n            return false;\n        if( @intCounterStandyBy < 10 )\n            @intTimeoutTimer = setTimeout( \n                this.onTimer.bind(this) , \n                @intIntervalTimer \n            );\n        else\n            if( @booMouseOver )\n                @intTimeoutTimer =  setTimeout( \n                    this.onTimer.bind( this ) , \n                    @intIntervalTimer * 2 \n                );\n            else\n                @intCounterStandyBy = 0;\n                @stop();\n                \n        if( @intCounterStandyBy > 10 )\n            @intCounterStandyBy = 10;\n        \n        if( !@booOnTimer )\n            @onTimerElements();\n        return true;\n\n    ###\n    # On show counter FPS\n    ###\n    onCountFps:->\n        @intLastFps = @intFps;\n        @intFps = 0;\n        if( ! @booCountFps )\n            return false;\n        document.title = \"FPS: \" + @intLastFps;\n        @intTimeoutFPS = setTimeout( \n            this.onCountFps.bind(this) , \n            1000 \n        );\n        return true;\n\n    ###\n    # Refresh the Canvas Box\n    #\n    # - Draw the elements\n    # - Call the next timer if should\n    ###\n    onDraw:->\n        if( @booActive == false )\n            return false;\n\n        @intTimeoutDraw = setTimeout( \n            this.onDraw.bind(this) , \n            @intIntervalDraw \n        );\n\n        if( ! @booOnDraw )\n            @draw();\n            @intFps++;\n        return true;\n\n    ###\n    # Refresh Mouse Position based on Event\n    #\n    # @param event Event\n    ###\n    refreshMousePosition:( event = null )->    \n        if( event? )\n            @mouseX = ( event.clientX - @x + CanvasBox::scrollLeft() ) / @dblZoom;\n            @mouseY = ( event.clientY - @y + CanvasBox::scrollTop()  ) / @dblZoom;\n\n    ###\n    # On Move Move over the Canvas Box\n    # Search if the Mouse is Over some Canvas Element\n    # @param event event\n    ###\n    onMouseMove:( event = null )->\n        objElementOver = null;\n        @refreshMousePosition( event );\n        for objElement in @arrElements\n            if( php.is_object( objElement ) && objElement.isInside( @mouseX , @mouseY ) )\n                @change()\n                objElementOver = objElement;\n                break;\n                \n        ##\n        # If the element over has changed \n        # ( null versus object ) or ( object.id != object.id )\n        ##\n        # if(   ( if @objElementOver == null then 0 else @objElementOver.getId() ) !=\n        #       ( if  objElementOver == null then 0 else  objElementOver.getId() )  )\n        ##\n        if(   @objElementOver != objElementOver )\n\n            @change()\n            \n            if( @objElementOver != null )\n                @objElementOver.onMouseOut( event );\n                \n            if(  objElementOver != null )\n                @booMouseOver = true\n                objElementOver.onMouseOver( event );\n                \n        if( objElementOver != null )\n            @objCanvasHtml.style.cursor = \"pointer\";\n        else\n            @objCanvasHtml.style.cursor = \"default\";\n            \n        @objElementOver = objElementOver;\n            \n        if( @objElementSelected? )\n            @change()\n            @objElementSelected.onDrag( event );\n\n        for objButton in @arrButtons\n            objButton.refresh();\n            if( objButton.booMouseOver != objButton.isInside( @mouseX * @dblZoom , @mouseY *  @dblZoom ) )\n                @change();\n\n    ###\n    # On Mouse Up Canvas Box Event\n    # \n    # @see onMouseDown\n    # @see CanvasBoxElement::onDrop()\n    # @param Event event\n    ###\n    onMouseUp:( event )->\n        @booMouseOver = true;\n\n        if( @objElementSelected? )\n            @change()\n            @objElementSelected.onDrop( event);\n        @objElementSelected = null;\n\n    ###\n    # On Mouse Down Canvas Box Event\n    # \n    # @param Event event\n    ###\n    onMouseDown:( event )->\n        @booMouseOver = true;\n        @change()\n        @objElementSelected = @objElementOver;\n        if( @objElementSelected? )\n            @objElementSelected.onMouseDown( event );\n        return false;\n\n    ###\n    # On Mouse Click Canvas Box Event\n    # \n    # @param Event event\n    ###\n    onClick:( event )->\n        @objCanvasHtml.focus();\n        @booMouseOver = true;\n        @change()\n        if( @booShowMenu )\n            @booShowMenu = @objMenuSelected.onClick( event );\n            return false;\n\n        if( @objElementOver != null )\n            @objElementClicked = @objElementOver;\n            @objElementOver.onClick( event );\n        else \n            @objElementClicked = null;\n            @onBoxClick( event );\n\n        for objButton in @arrButtons\n            objButton.refresh();\n            if( objButton.booMouseOver )\n                objButton.onClick();\n                \n        return false;\n\n    ###\n    # On Double Click Canvas Box Event\n    # \n    # @param Event event\n    ###\n    onDblClick:( event )->\n        @booMouseOver = true;\n        @change()\n        if( @objElementOver != null )\n            @objElementOver.onDblClick( event );\n        else\n            @onBoxDblClick( event );\n\n    ###\n    # On Right Click Canvas Box Event\n    # \n    # @param Event event\n    ###\n    onBoxRightClick:( event )->\n        @booMouseOver = true;\n        @change()\n        return false;\n\n    ###\n    # On Context Menu Canvas Box Event\n    # \n    # @param Event event\n    ###\n    onContextMenu:( event )->\n        @booMouseOver = true;\n        @change()\n        if( @objElementOver != null )\n            @objElementOver.onContextMenu( event );\n        else\n            @onBoxContextMenu( event );\n        return false;\n\n    ###\n    # On Context Menu Clicked into a empty space of the Canvas Box\n    # @param Event event\n    ###\n    onBoxContextMenu:( event )->\n        @booMouseOver = true;\n        @change()\n\n        @booShowMenu = !@booShowMenu;\n        if( @booShowMenu )\n            @objMenu.objBox = this;\n            @objMenuSelected = @objMenu;\n            @objMenuSelected.intMenuX = @mouseX;\n            @objMenuSelected.intMenuY = @mouseY;\n            @objMenuSelected.strActualMenuItem = null;\n\n    ###\n    #  On Click into a empty space of the Canvas Box\n    # \n    # @param Event event\n    ###\n    onBoxClick:( event )->\n        @booMouseOver = true;\n        @change()\n        if( @booShowMenu )\n            @booShowMenu = @objMenuSelected.onClick( event );\n\n    ###\n    # On Double click into a empty space of the Canvas Box\n    # \n    # @param Event event\n    ###\n    onBoxDblClick:( event )->\n        @booMouseOver = true;\n        @change()\n\n    ###\n    # On Key Up into the Canvas Box Element\n    # \n    # @param Event event\n    ###\n    onKeyUp:( event )->\n        @change()\n        switch event.keyCode\n            \n            when 46 then ( # delete\n                if( @objElementClicked != null )\n                    @deleteElement( @objElementClicked )\n                )\n            when 38 then ( # up\n                if( @objElementClicked != null )\n                    @objElementClicked.goUp();\n                )\n            when 40 then ( # down\n                if( @objElementClicked != null )\n                    @objElementClicked.goDown();\n                )\n            when 39 then ( # =>\n                if( @objElementClicked != null )\n                    @objElementClicked.goRight();\n                )\n            when 37 then ( # <=\n                if( @objElementClicked != null )\n                    @objElementClicked.goLeft();\n                )\n            when 32 then ( # SPACE\n                if( @objElementClicked != null )\n                    @objElementClicked.fixed = not @objElementClicked.fixed;\n                    @objElementClicked.drawFixed( @objElementClicked.fixed );\n                )\n            when 113 then ( # F2\n                if( @objElementClicked != null )\n                    @objElementClicked.rename();\n                )\n            when 45 then ( # INSERT\n                if( @objElementClicked != null )\n                    @objElementClicked.copy();\n                )\n        return false;\n\n    ###\n    # Delete some element from the Canvas Box\n    # \n    # @param CanvasBoxElement objElement\n    # @param boolean booCallOnDelete\n    ###\n    deleteElement:( objElement , booCallOnDelete = true )->\n        @change()\n\n        if( booCallOnDelete )\n            objElement.onDelete();\n\n        intId = @arrElements.indexOf( objElement );\n\n        console.log(\" index of intId \" );\n        \n        if( intId != -1 )\n            @arrElements.splice( intId  , 1 );\n        if ( @arrElements.length > 0 )\n            @objElementClicked = null\n        else\n            @objElementClicked = null;\n    \n    onMouseOver:( event )->\n        @booMouseOver = true;\n        @play();\n    \n    onMouseOut:( event )->\n        @booMouseOver = false;\n    \n    change:->\n        @play();\n        @intCounterStandyBy = 0;\n        @booChanged = true;\n\n    moveTo:( intX , intY )->\n        @getContext().moveTo( \n            Math.round( intX * @dblZoom ),\n            Math.round( intY * @dblZoom )\n        );\n\n    lineTo:( intX , intY )->\n        @getContext().lineTo(\n            Math.round( intX * @dblZoom ) + 0.5 ,\n            Math.round( intY * @dblZoom ) + 0.5\n        );\n\n    quadraticCurveTo:( intCurveX , intCurveY, intX , intY )->\n        @getContext().quadraticCurveTo(\n            Math.round( intCurveX * @dblZoom ),\n            Math.round( intCurveY * @dblZoom ),\n            Math.round( intX * @dblZoom ) + 0.5 ,\n            Math.round( intY * @dblZoom ) + 0.5\n        );\n\n    bezierCurveTo:( intCurveX , intCurveY, intX , intY )->\n        \n        @getContext().bezierCurveTo(\n          Math.round( intCurveX * @dblZoom ), \n          Math.round( intCurveY * @dblZoom ), \n          Math.round( intCurveX * @dblZoom ), \n          Math.round( intCurveY * @dblZoom ) , \n          Math.round( intX  * @dblZoom ), \n          Math.round( intY * @dblZoom )\n        )\n\n    arc:( intX , intY, dblRadius , dblStartAngle , dblEndAngle, booClockwise)->\n        @getContext().arc(\n            Math.round( intX * @dblZoom  ),\n            Math.round( intY * @dblZoom  ),\n            Math.abs( Math.round( dblRadius * @dblZoom  ) ),\n            dblStartAngle ,\n            dblEndAngle ,\n            booClockwise\n        );\n\n    defaultStyle:->\n        @setFillStyle(\"red\");\n        @setStrokeStyle(\"red\");\n        @setLineWidth(\"1px\");\n        \n    saveContext:->\n        @getContext().save();\n        @defaultStyle();\n\n    restoreContext:->\n        @getContext().restore();\n        @defaultStyle();\n\n    beginPath:->\n        @getContext().beginPath();\n\n    closePath:->\n        @getContext().closePath();\n\n    setFillStyle:( strFillStyle )->\n        try\n          if( not strFillStyle? )\n              objError = throw new CanvasBoxException( \"Fill Style not defined\");\n          @getContext().fillStyle = strFillStyle;\n        catch objError\n          throw new CanvasBoxException( \"Error on set Fill Style [#{strFillStyle}]\" );\n          \n    \n    setStrokeStyle:( strStrokeStyle )->\n        try\n          if( not strStrokeStyle? )\n              objError = new CanvasBoxException( \"Stroke Style not defined\");\n              throw objError\n          @getContext().strokeStyle = ( strStrokeStyle );\n        catch objError\n          throw new CanvasBoxException( \"Error on set Stroke Style [#{strStrokeStyle}]\" );\n\n    setLineWidth:( dblLineWidth )->\n        try\n          @getContext().lineWidth = ( dblLineWidth * @dblZoom );\n        catch objError\n          throw new CanvasBoxException( \"Error on set Line Width [#{dblLineWidth}]\" );\n\n    fill:->\n        @getContext().fill();\n\n    stroke:->\n        @getContext().stroke();\n\n    strokeText:( strText , intPosX , intPosY )->\n        try\n          @getContext().strokeText(\n              strText ,\n              Math.round( intPosX * @dblZoom ),\n              Math.round( intPosY * @dblZoom )\n          );\n        catch objError\n          throw new CanvasBoxException( \"Error on set Stroke Text\" );\n\n    fillText:( strText , intPosX , intPosY )->\n        try\n          @getContext().fillText(\n              strText ,\n              Math.round( intPosX * @dblZoom ) + 0.5,\n              Math.round( intPosY * @dblZoom ) + 0.5\n          );\n        catch objError\n          throw new CanvasBoxException( \"Error on fill Text\" );\n\n    strokeRect:( intX, intY, intWidth, intHeight )->\n        try\n          @getContext().strokeRect(\n              Math.round( intX        * @dblZoom ) + 0.5,\n              Math.round( intY        * @dblZoom ) + 0.5,\n              Math.round( intWidth    * @dblZoom ) + 0.5,\n              Math.round( intHeight   * @dblZoom ) + 0.5\n          );\n        catch objError\n          throw new CanvasBoxException( \"Error on stroke Rect\" );\n\n    fillRect:( intX, intY, intWidth, intHeight )->\n        try\n          @getContext().fillRect(\n              Math.round( intX        * @dblZoom ) + 0.5,\n              Math.round( intY        * @dblZoom ) + 0.5,\n              Math.round( intWidth    * @dblZoom ) + 0.5,\n              Math.round( intHeight   * @dblZoom ) + 0.5\n          );\n        catch objError\n          throw new CanvasBoxException( \"Error on fill Rect\" );\n\n    setShadowOffsetX:( intX )->\n        try\n          @getContext().shadowOffsetX = Math.round( intX * @dblZoom );\n        catch objError\n          throw new CanvasBoxException( \"Error on set Shadow Offset X\" );\n\n    setShadowOffsetY:( intY )->\n        try\n          @getContext().shadowOffsetY = Math.round( intY * @dblZoom );\n        catch objError\n          throw new CanvasBoxException( \"Error on set Shadow Offset Y\" );\n\n    setShadowBlur:( intBlur )->\n        try\n          @getContext().shadowBlur = intBlur;\n        catch objError\n          throw new CanvasBoxException( \"Error on set Shadow Blur\" );\n\n    setShadowColor:( strColor )->\n        try\n          #console.log( \"set shadown color = \" + strColor );\n          @getContext().shadowColor = strColor;\n        catch objError\n          throw new CanvasBoxException( \"Error on set Shadow Color\" );\n\n    setFont:( strFontDescription )->\n        try\n          #console.log( \"set Font \" + strFontDescription );\n          arrFontData = php.explode( \" \" , strFontDescription );\n          for strFontData , key in arrFontData\n            if  strFontData.indexOf( \"px\" ) > -1 or\n                strFontData.indexOf( \"pt\" ) > -1\n              strSizeNumber = strFontData.substr( 0 , strFontData.length - 2 );\n              strSizeType   = strFontData.substr( strFontData.length - 2 );\n              dblSizeNumber = 1 * strSizeNumber;\n              dblSizeNumber = dblSizeNumber * @dblZoom;\n              strNewSizeNumber = dblSizeNumber + strSizeType;\n              arrFontData[ key ] = strNewSizeNumber;\n          strFontDescription = php.implode( \" \" , arrFontData );\n          @getContext().font = strFontDescription;\n        catch objError\n          throw new CanvasBoxException( \"Error on set Font #{strFontDescription}\" );\n\n    translate:( intX , intY )->\n        try\n            @getContext().translate(\n                intX, \n                intY\n            );\n        catch objError\n          throw new CanvasBoxException( \"Error on translate\" );\n\n    drawLine:( intXfrom , intYfrom , intXto , intYto )->\n        try\n          @getContext().moveTo( intXfrom + 0.5 , intYfrom + 0.5 )\n          @getContext().lineTo( intXto   + 0.5 , intYto + 0.5 )\n        catch objError\n          objCanvasError = new CanvasBoxException( \"Error on drawLine\" );\n          objCanvasError.setParentError( objError )\n          throw objCanvasError\n\n    drawQuadraticLine:( intXfrom , intYfrom , intXto , intYto , intXCurve , intYCurve )->\n\n        try\n          @getContext().moveTo( intXfrom + 0.5, intYfrom + 0.5 )\n          @getContext().quadraticCurveTo( intXCurve, intYCurve, intXto + 0.5  , intYto + 0.5)\n        catch objError\n          objCanvasError = new CanvasBoxException( \"Error on quadraticCurveTo\" );\n          objCanvasError.setParentError( objError )\n          throw objCanvasError\n\n    drawBezierLine:( intXfrom , intYfrom , intXto , intYto , intXCurve , intYCurve )->\n\n        try\n          @getContext().moveTo( intXfrom + 0.5, intYfrom + 0.5 )\n          @bezierCurveTo( intXCurve, intYCurve, intXto + 0.5, intYto + 0.5)\n        catch objError\n          objCanvasError = new CanvasBoxException( \"Error on drawBezierLine\" );\n          objCanvasError.setParentError( objError )\n          throw objCanvasError\n\n    rotate:( dblDegree )->\n        try\n          @getContext().rotate( dblDegree );\n        catch objError\n          throw new CanvasBoxException( \"Error on rotate\" );\n\n    setTextAlign:( strTextAling )->\n        try\n          #console.log( \"set Text Align \" + strTextAling  );\n          @getContext().textAlign = strTextAling;\n        catch objError\n          throw new CanvasBoxException( \"Error on setTextAling #{strTextAling}\" );\n    \n    addButton:( objButton )->\n        objButton.intPaddingLeft = 0;\n        objButton.intPaddingTop = 0;\n        if( @arrButtons.length > 0 )\n            objButton.strPositionHorizontal = \"right\";\n            objButton.strPositionVertical = \"middle\";\n            objButton.objPreviousButton = @arrButtons[ @arrButtons.length - 1 ];\n        else\n            objButton.strPositionHorizontal = \"left\";\n            objButton.strPositionVertical = \"top\";\n        @arrButtons.push( objButton );\n\n    saveFile:()->\n        dblProportion = @defaultHeight / @defaultWidth;\n        intWidth = 1000;\n        intHeight = Math.round( intWidth / dblProportion );\n        dblOldZoom = @dblZoom;\n        dblNewZoom = intWidth / @defaultWidth;\n        @objCanvasHtml.setAttribute( \"width\" ,  ( intWidth )  + \"px\" );\n        @objCanvasHtml.setAttribute( \"height\" , ( intHeight ) + \"px\" );\n\n        @dblZoom = dblNewZoom;\n        \n        objNewForm = document.createElement( \"form\" );\n        objNewTextArea = document.createElement( \"textarea\" );\n        objInputName = document.createElement( \"input\" );\n        objInputImageType = document.createElement( \"input\" );\n\n        @onMouseOut( null );\n        @booDrawBoxMenu = false;\n        @stop();\n        @draw();\n\n        strDataURI = @objCanvasHtml.toDataURL( \"image/png\" );\n        strDefaultFolder = window.MAIN_PATH;\n        objNewForm.setAttribute( \"action\" , strDefaultFolder + \"/download.php\" );\n        objNewForm.setAttribute( \"method\" , \"post\" );\n        objNewForm.setAttribute( \"target\" , \"saveWindow\" );\n\n        objNewTextArea.setAttribute( \"name\" , \"base64Content\" );\n        objNewTextArea.value = strDataURI;\n\n        objInputName.setAttribute( \"type\" , \"text\" );\n        objInputName.setAttribute( \"name\", \"fileName\" );\n        objInputName.value = \"diagram.png\";\n\n        objInputImageType.setAttribute( \"type\" , \"text\" );\n        objInputImageType.setAttribute( \"name\", \"imageType\" );\n        objInputImageType.value = \"image/png\";\n\n        objNewForm.appendChild( objNewTextArea );\n        objNewForm.appendChild( objInputName );\n        objNewForm.appendChild( objInputImageType );\n\n        document.body.appendChild( objNewForm );\n\n        objNewForm.submit();\n        @play();\n        @booDrawBoxMenu = true;\n        window.setTimeout(\n            () -> window.open( '../default/close.html' , 'saveWindow') ,\n            30000\n        )\n        document.body.removeChild( objNewForm );\n        @dblZoom = dblOldZoom;\n        @objCanvasHtml.setAttribute( \"width\" ,  ( @defaultWidth )  + \"px\" );\n        @objCanvasHtml.setAttribute( \"height\" , ( @defaultHeight ) + \"px\" );\n\n    saveAsXml:()->\n        alert( \"Feature in development. Try it tomorrow!\");\n\n###\n# Canvas Box it is a canvas element where the user can be append and remove elements.\n#\n# It elements can be selected and clicked and interact each other.\n# @author Thiago Henrique Ramos da Mata <thiago.henrique.mata@gmail.com>\n###\nCanvasBox::arrInstances = Array()\n\n###\n# Get instance of canvas box by its id\n###\nCanvasBox::getCanvasBoxById = (id ) ->\n    return CanvasBox::arrInstances[ id ]\n\n\n###\n# Get the client height fixing browsers missing standarts\n#\n# @link http:#www.softcomplex.com/docs/get_window_size_and_scrollbar_position.html\n###\nCanvasBox::clientHeight = ->\n    return CanvasBox::filterResults(\n        window.innerHeight ?= 0,\n        document.documentElement ?= 0,\n        document.body ?= 0\n    );\n\n###\n# Get the scroll left fixing browsers missing standarts\n#\n# @link http:#www.softcomplex.com/docs/get_window_size_and_scrollbar_position.html\n###\nCanvasBox::scrollLeft = ->\n    return CanvasBox::filterResults(\n        window.pageXOffset ?= 0,\n        document.documentElement.scrollWidth ?= 0,\n        document.body.scrollWidth ?= 0\n    );\n\n\n###\n# Get the scroll Top fixing browsers missing standarts\n#\n# @link http:#www.softcomplex.com/docs/get_window_size_and_scrollbar_position.html\n###\nCanvasBox::scrollTop = ->\n    return CanvasBox::filterResults(\n        window.pageYOffset ?= 0,\n        document.documentElement.scrollHeight ?= 0,\n        document.body.scrollHeight ?= 0\n    );\n\n###\n# browsers workaround for missing standarts\n# @link http:#www.softcomplex.com/docs/get_window_size_and_scrollbar_position.html\n###\nCanvasBox::filterResults = (intWin, intDocel, intBody) ->\n    # the workaround stop to work.. around :P\n    return intWin;\n    intresult = intWin ?= 0;\n    if (intDocel && (!intresult || (intresult > intDocel))) \n        intresult = intDocel;\n    return intBody && (!intresult || (intresult > intBody)) ? intBody : intresult;\n"]}