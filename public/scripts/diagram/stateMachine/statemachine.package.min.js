var CanvasBoxState,__hasProp={}.hasOwnProperty,__extends=function(t,o){function e(){this.constructor=t}for(var r in o)__hasProp.call(o,r)&&(t[r]=o[r]);return e.prototype=o.prototype,t.prototype=new e,t.__super__=o.prototype,t};Load.CanvasBoxElement(),CanvasBoxState=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return __extends(o,t),o.prototype.width=90,o.prototype.height=90,o.prototype.z=3,o.prototype.borderColor="rgb(10,10,10)",o.prototype.borderWidth=1,o.prototype.strStateName="state",o.prototype.fillColor="rgb( 232 , 232, 255  )",o.prototype.fixedColor="rgb( 200, 200 ,200 )",o.prototype.overColor="rgb( 100 , 200 , 200 )",o.prototype.dragColor="rgb( 200 , 200 , 250 )",o.prototype.strClassName="CanvasBoxState",o.prototype.side=45,o.prototype.initialize=function(){return this.init(),this.objMenu=new autoload.newCanvasBoxMenu,this.objMenu.objBox=this.objBox,this.objMenu.arrMenuItens={0:{name:"create from state",event:function(){return function(t){var o,e,r,i;switch(o=New.CanvasBoxState(),o.objBehavior=new window[t.objBehavior.strClassName](o),o.x=t.objBox.mouseX+100,o.y=t.objBox.mouseY+100,t.objBox.addElement(o),e=o,i=t,r=New.CanvasBoxStateLink(e,i),t.objBehavior.strClassName){case"CanvasBoxMagneticBehavior":r.objBehavior=new autoload.newCanvasBoxMagneticConnectorBehavior(r);break;case"CanvasBoxDefaultBehavior":break;default:r.objBehavior=new autoload.newCanvasBoxDefaultConnectorBehavior(r)}return r.x=(e.x+i.x)/2,r.y=(e.y+i.y)/2,t.objBox.addElement(r)}}(this)},1:{name:"create to state",event:function(){return function(t){var o,e,r,i;switch(o=New.CanvasBoxState(),o.objBehavior=new window[t.objBehavior.strClassName](o),o.x=t.objBox.mouseX+100,o.y=t.objBox.mouseY+100,t.objBox.addElement(o),e=t,i=o,r=New.CanvasBoxStateLink(e,i),t.objBehavior.strClassName){case"CanvasBoxMagneticBehavior":r.objBehavior=new autoload.newCanvasBoxMagneticConnectorBehavior(r);break;case"CanvasBoxDefaultBehavior":break;default:r.objBehavior=new autoload.newCanvasBoxDefaultConnectorBehavior(r)}return r.x=(e.x+i.x)/2,r.y=(e.y+i.y)/2,t.objBox.addElement(r)}}(this)}}},o.prototype.toSerialize=function(){var t;return t={x:Math.round(this.x),y:Math.round(this.y),width:this.width,height:this.height,Color:this.fillColor,borderColor:this.borderColor,borderWidth:this.borderWidth,intMass:this.intMass,intMagnetism:this.intMagnetism,strClassName:this.strClassName,arrAttributes:this.arrAttributes,arrMethods:this.arrMethods,fillColor:this.fillColor,fixedColor:this.fixedColor,overColor:this.overColor,dragColor:this.dragColor,intWallRepelsForce:this.intWallRepelsForce}},o.prototype.refresh=function(){return this.width=2*this.side,this.height=2*this.side,this.x0=this.x-this.width/2,this.x1=this.x+this.width/2,this.y0=this.y-this.height/2,this.y1=this.y+this.height/2,o.__super__.refresh.apply(this,arguments)},o.prototype.draw=function(){return this.refresh(),this.objBox.saveContext(),(this.mouseOver||this.objBox.objElementClicked===this)&&(this.objBox.setStrokeStyle("rgb( 200 , 200 , 250 )"),this.objBox.setLineWidth(1),this.objBox.beginPath(),this.objBox.arc(this.x,this.y,this.side+10,0,2*Math.PI,!0),this.objBox.stroke(),this.objBox.closePath()),this.objBox.setStrokeStyle(this.borderColor),this.objBox.setFillStyle(this.fillColor),this.objBox.beginPath(),this.objBox.arc(this.x,this.y,this.side,0,2*Math.PI,!0),this.objBox.fill(),this.objBox.closePath(),this.objBox.setLineWidth("0.5"),this.objBox.setFont("10px Arial lighter"),this.objBox.setTextAlign("center"),this.objBox.strokeText(this.strStateName,this.x,this.y),this.objBox.restoreContext()},o.prototype.drawMouseOver=function(){return this.defaultColor||(this.defaultColor=this.fillColor),this.fillColor=this.overColor},o.prototype.drawMouseOut=function(){return this.defaultColor?this.fillColor=this.fixed?this.fixedColor:this.defaultColor:void 0},o.prototype.drawDrag=function(){return this.defaultColor||(this.defaultColor=this.fillColor),this.fillColor=this.dragColor},o.prototype.drawDrop=function(){return this.defaultColor?this.fillColor=this.fixed?this.fixedColor:this.defaultColor:void 0},o.prototype.drawFixed=function(t){return console.log("fixed! "),this.fixed=t,this.fillColor=t?this.fixedColor:this.mouseOver?this.overColor:this.defaultColor},o.prototype.rename=function(){var t;return t=prompt("Inform the new name of the state."),null!==t?this.strStateName=t:void 0},o.prototype.onMouseOver=function(){return console.log("On Mouse Over"),o.__super__.onMouseOver.apply(this,arguments)},o.prototype.isInsideElement=function(t,o){return t>=this.x-this.side&&t<=this.x+this.side&&o>=this.y-this.side&&o<=this.y+this.side},o}(CanvasBoxElement);
var CanvasBoxStateDiagram,__hasProp={}.hasOwnProperty,__extends=function(t,n){function e(){this.constructor=t}for(var o in n)__hasProp.call(n,o)&&(t[o]=n[o]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};Load.CanvasBox(),CanvasBoxStateDiagram=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.strClassName="CanvasBoxStateDiagram",n.prototype.defineMenu=function(){return this.objMenu=New.CanvasBoxMenu(),this.objMenu.objParent=this,this.objMenu.ojbBox=this,this.objMenu.ojbParent=this,this.objMenu.arrMenuItens={0:{name:"create state",event:function(){return function(t){var n;return n=New.CanvasBoxState(),n.objBehavior=New.CanvasBoxMagneticBehavior(n),n.x=t.mouseX,n.y=t.mouseY,t.addElement(n)}}(this)}},this.objMenuSelected=null},n.prototype.addLine=function(t,n){var e;if(null===t)throw new CanvasBoxException("Line has no element from");if(null===n)throw new CanvasBoxException("Line has no element to");return e=New.CanvasBoxStateLink(t,n),this.addElement(e),e},n.prototype.addState=function(t,n,e){var o;return null==n&&(n=null),null==e&&(e=null),o=New.CanvasBoxState(),null===n&&(n=Math.round(1200*Math.random())),null===e&&(e=Math.round(1200*Math.random())),o.x=n,o.y=e,o.objBehavior=New.CanvasBoxMagneticBehavior(o),o.strStateName=t,this.addElement(o),o},n.prototype.load=function(t){var n,e,o,a,r,s,i,u,l,h;n=[],u=t.states;for(o in u)i=u[o],s=this.addState(i.name,i.x,i.y),i.color&&(s.fillColor=i.color),n[i.id]=s;l=t.lines,h=[];for(e in l)r=l[e],a=this.addLine(n[r.from],n[r.to]),h.push(a.strName=r.name);return h},n}(CanvasBox);
var CanvasBoxStateLink,__hasProp={}.hasOwnProperty,__extends=function(t,o){function r(){this.constructor=t}for(var e in o)__hasProp.call(o,e)&&(t[e]=o[e]);return r.prototype=o.prototype,t.prototype=new r,t.__super__=o.prototype,t};Load.CanvasBoxLine(),CanvasBoxStateLink=function(t){function o(){return o.__super__.constructor.apply(this,arguments)}return __extends(o,t),o.prototype.strName=null,o.prototype.strTitle=null,o.prototype.color="black",o.prototype.toSerialize=function(){var t;return t={x:Math.round(this.x),y:Math.round(this.y),side:this.side,color:this.color,borderColor:this.borderColor,borderWidth:this.borderWidth,intMass:this.intMass,intMagnetism:this.intMagnetism,intWallRepelsForce:this.intWallRepelsForce,name:this.constructor.name}},o.prototype.drawArrowTo=function(){return this.objBox.moveTo(-10,15),this.objBox.lineTo(0,0),this.objBox.lineTo(10,15)},o}(CanvasBoxLine);
var CanvasBoxStateRender,__hasProp={}.hasOwnProperty,__extends=function(o,e){function t(){this.constructor=o}for(var r in e)__hasProp.call(e,r)&&(o[r]=e[r]);return t.prototype=e.prototype,o.prototype=new t,o.__super__=e.prototype,o};Load.CanvasBoxRender(),CanvasBoxStateRender=function(o){function e(){return e.__super__.constructor.apply(this,arguments)}return __extends(e,o),e.prototype.arrGrammar=[{rule:"(.*)>(.*)",method:"addGo"},{rule:"(.*)<(.*)",method:"addBack"},{rule:"(.*)",method:"addMe"}],e.prototype.loadHash=function(o){var e,t,r,n,a,p,d,l;for(d=this.arrGrammar,l=[],a=0,p=d.length;p>a;a++)r=d[a],t=new RegExp(r.rule),n=o,l.push(function(){var o;for(o=[];""!==n&&t.test(n);)console.log("p1 "+n),e=t.exec(n),n=this[r.method](n),o.push(console.log("p2 "+n));return o}.call(this));return l},e.prototype.addGo=function(o){var e,t,r;if(console.log("add go "+o),e=php.explode(">",o),!(e.length>1))return this.addMe(o);for(t=e.pop();e.length>1;)r=e.pop(),this.addLink(t,r),t=r;return console.log("returning1 "+t),t},e.prototype.addBack=function(o){var e,t,r;if(console.log("add back "+o),e=php.explode("<",o),!(e.length>1))return this.addMe(o);for(r=e.pop();e.length>0;)t=e.pop(),this.addLink(t,r),r=t;return console.log("returning1 "+r),r},e.prototype.addMe=function(o){return console.log(o),""},e.prototype.updateElement=function(o){return console.log("update element "+o),o},e.prototype.addLink=function(o,e){return console.log("create link from "+o+" to "+e)},e}(CanvasBoxRender);